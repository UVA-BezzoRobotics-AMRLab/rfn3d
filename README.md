# RFN3D Planner for MRS simulator
This is the University of Virginia's Robust Fast Navigation (3D) planner, modified to run on top of CTU's [MRS UAV System](https://github.com/ctu-mrs/mrs_uav_system)

## Installation
This package has the following dependencies:
* Apt repositories: FCL, Octomap, PCL
  ```bash
  sudo apt-get install libfcl-dev libpcl-dev ros-<ros_version>-octomap*
  ```
* [mav_trajectory_generation](https://github.com/ethz-asl/mav_trajectory_generation)
* [OMPL](https://ompl.kavrakilab.org/installation.html)
* [Gurobi](https://www.gurobi.com/downloads/gurobi-software/)
* [MRS UAV System](https://github.com/ctu-mrs/mrs_uav_system)

## Running
Consists of two nodes, the `planner` and the `local_octomap`. The `planner` takes care of collision-avoidant trajectories based on the octomap generated by `local_octomap`. The planner should already be setup to run with the UAS_MAPPING_CORE 
simulation. It can be launched via

```bash
roslaunch rfn3d planner.launch
```

To publish a goal, publish to the <goal_topic> (`clicked_point` by default):

```bash
rostopic pub <goal_topic> geometry_msgs/PointStamped "header:
  seq: 0
  stamp:
    secs: 0
    nsecs: 0
  frame_id: <frame>
point:
  x: <xg>
  y: <yg>
  z: <zg>"
```

## Parameters
The system has parameters to adjust the octomap, trajectory generation, and planner logistics. These parameters and their descriptions can be found in `./params/params.yaml`

## TODOS
* Transform for pointcloud needs to be adjusted in `local_octomap`. Currently just adds SE3 position of UAV to pointcloud readings.
* Add orientation to planner, should be relatively straightforward to achieve this.
